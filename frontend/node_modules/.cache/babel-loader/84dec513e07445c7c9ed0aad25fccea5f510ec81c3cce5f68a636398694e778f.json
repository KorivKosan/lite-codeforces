{"ast":null,"code":"import Header from \"./components/Header\";\nimport Middle from \"./components/Middle\";\nimport Footer from \"./components/Footer\";\nimport axios from \"axios\";\nconst __default__ = {\n  name: 'App',\n  components: {\n    Footer,\n    Middle,\n    Header\n  },\n  data: function () {\n    return {\n      user: null,\n      posts: [],\n      users: []\n    };\n  },\n  beforeMount() {\n    if (localStorage.getItem(\"jwt\") && !this.user) {\n      this.$root.$emit(\"onJwt\", localStorage.getItem(\"jwt\"));\n    }\n    axios.get(\"/api/1/posts\").then(response => {\n      this.posts = response.data;\n    });\n    axios.get(\"/api/1/users\").then(response => {\n      this.users = response.data;\n    });\n  },\n  beforeCreate() {\n    this.$root.$on(\"onEnter\", (login, password) => {\n      if (password === \"\") {\n        this.$root.$emit(\"onEnterValidationError\", \"Password is required\");\n        return;\n      }\n      axios.post(\"/api/1/jwt\", {\n        login,\n        password\n      }).then(response => {\n        localStorage.setItem(\"jwt\", response.data);\n        this.$root.$emit(\"onJwt\", response.data);\n      }).catch(error => {\n        this.$root.$emit(\"onEnterValidationError\", error.response.data);\n      });\n    });\n    this.$root.$on(\"onJwt\", jwt => {\n      localStorage.setItem(\"jwt\", jwt);\n      axios.get(\"/api/1/users/auth\", {\n        params: {\n          jwt\n        }\n      }).then(response => {\n        this.user = response.data;\n        this.$root.$emit(\"onChangePage\", \"Index\");\n      }).catch(() => this.$root.$emit(\"onLogout\"));\n    });\n    this.$root.$on(\"onLogout\", () => {\n      localStorage.removeItem(\"jwt\");\n      this.user = null;\n    });\n  }\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  setup(__props) {\n    return {\n      __sfc: true,\n      Header,\n      Middle,\n      Footer\n    };\n  }\n});","map":{"version":3,"names":["Header","Middle","Footer","axios","__default__","name","components","data","user","posts","users","beforeMount","localStorage","getItem","$root","$emit","get","then","response","beforeCreate","$on","login","password","post","setItem","catch","error","jwt","params","removeItem"],"sources":["App.vue"],"sourcesContent":["<template>\n    <div id=\"app\">\n        <Header :user=\"user\"/>\n        <Middle :posts=\"posts\" :users=\"users\"/>\n        <Footer/>\n    </div>\n</template>\n\n<script>\nimport Header from \"./components/Header\";\nimport Middle from \"./components/Middle\";\nimport Footer from \"./components/Footer\";\nimport axios from \"axios\"\n\nexport default {\n    name: 'App',\n    components: {\n        Footer,\n        Middle,\n        Header\n    },\n    data: function () {\n        return {\n            user: null,\n            posts: [],\n            users: []\n        }\n    },\n    beforeMount() {\n        if (localStorage.getItem(\"jwt\") && !this.user) {\n            this.$root.$emit(\"onJwt\", localStorage.getItem(\"jwt\"));\n        }\n\n        axios.get(\"/api/1/posts\").then(response => {\n            this.posts = response.data;\n        });\n\n        axios.get(\"/api/1/users\").then(response => {\n            this.users = response.data;\n        });\n    },\n    beforeCreate() {\n        this.$root.$on(\"onEnter\", (login, password) => {\n            if (password === \"\") {\n                this.$root.$emit(\"onEnterValidationError\", \"Password is required\");\n                return;\n            }\n\n            axios.post(\"/api/1/jwt\", {\n                    login, password\n            }).then(response => {\n                localStorage.setItem(\"jwt\", response.data);\n                this.$root.$emit(\"onJwt\", response.data);\n            }).catch(error => {\n                this.$root.$emit(\"onEnterValidationError\", error.response.data);\n            });\n        });\n\n        this.$root.$on(\"onJwt\", (jwt) => {\n            localStorage.setItem(\"jwt\", jwt);\n\n            axios.get(\"/api/1/users/auth\", {\n                params: {\n                    jwt\n                }\n            }).then(response => {\n                this.user = response.data;\n                this.$root.$emit(\"onChangePage\", \"Index\");\n            }).catch(() => this.$root.$emit(\"onLogout\"))\n        });\n\n        this.$root.$on(\"onLogout\", () => {\n            localStorage.removeItem(\"jwt\");\n            this.user = null;\n        });\n\n    }\n}\n</script>\n\n<style>\n#app {\n\n}\n</style>\n<script setup>\n</script>"],"mappings":"AASA,OAAOA,MAAM,MAAM,qBAAqB;AACxC,OAAOC,MAAM,MAAM,qBAAqB;AACxC,OAAOC,MAAM,MAAM,qBAAqB;AACxC,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAAC,WAAA,GAAe;EACXC,IAAI,EAAE,KAAK;EACXC,UAAU,EAAE;IACRJ,MAAM;IACND,MAAM;IACND;EACJ,CAAC;EACDO,IAAI,EAAE,SAAAA,CAAA,EAAY;IACd,OAAO;MACHC,IAAI,EAAE,IAAI;MACVC,KAAK,EAAE,EAAE;MACTC,KAAK,EAAE;IACX,CAAC;EACL,CAAC;EACDC,WAAWA,CAAA,EAAG;IACV,IAAIC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAACL,IAAI,EAAE;MAC3C,IAAI,CAACM,KAAK,CAACC,KAAK,CAAC,OAAO,EAAEH,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC,CAAC;IAC1D;IAEAV,KAAK,CAACa,GAAG,CAAC,cAAc,CAAC,CAACC,IAAI,CAACC,QAAQ,IAAI;MACvC,IAAI,CAACT,KAAK,GAAGS,QAAQ,CAACX,IAAI;IAC9B,CAAC,CAAC;IAEFJ,KAAK,CAACa,GAAG,CAAC,cAAc,CAAC,CAACC,IAAI,CAACC,QAAQ,IAAI;MACvC,IAAI,CAACR,KAAK,GAAGQ,QAAQ,CAACX,IAAI;IAC9B,CAAC,CAAC;EACN,CAAC;EACDY,YAAYA,CAAA,EAAG;IACX,IAAI,CAACL,KAAK,CAACM,GAAG,CAAC,SAAS,EAAE,CAACC,KAAK,EAAEC,QAAQ,KAAK;MAC3C,IAAIA,QAAQ,KAAK,EAAE,EAAE;QACjB,IAAI,CAACR,KAAK,CAACC,KAAK,CAAC,wBAAwB,EAAE,sBAAsB,CAAC;QAClE;MACJ;MAEAZ,KAAK,CAACoB,IAAI,CAAC,YAAY,EAAE;QACjBF,KAAK;QAAEC;MACf,CAAC,CAAC,CAACL,IAAI,CAACC,QAAQ,IAAI;QAChBN,YAAY,CAACY,OAAO,CAAC,KAAK,EAAEN,QAAQ,CAACX,IAAI,CAAC;QAC1C,IAAI,CAACO,KAAK,CAACC,KAAK,CAAC,OAAO,EAAEG,QAAQ,CAACX,IAAI,CAAC;MAC5C,CAAC,CAAC,CAACkB,KAAK,CAACC,KAAK,IAAI;QACd,IAAI,CAACZ,KAAK,CAACC,KAAK,CAAC,wBAAwB,EAAEW,KAAK,CAACR,QAAQ,CAACX,IAAI,CAAC;MACnE,CAAC,CAAC;IACN,CAAC,CAAC;IAEF,IAAI,CAACO,KAAK,CAACM,GAAG,CAAC,OAAO,EAAGO,GAAG,IAAK;MAC7Bf,YAAY,CAACY,OAAO,CAAC,KAAK,EAAEG,GAAG,CAAC;MAEhCxB,KAAK,CAACa,GAAG,CAAC,mBAAmB,EAAE;QAC3BY,MAAM,EAAE;UACJD;QACJ;MACJ,CAAC,CAAC,CAACV,IAAI,CAACC,QAAQ,IAAI;QAChB,IAAI,CAACV,IAAI,GAAGU,QAAQ,CAACX,IAAI;QACzB,IAAI,CAACO,KAAK,CAACC,KAAK,CAAC,cAAc,EAAE,OAAO,CAAC;MAC7C,CAAC,CAAC,CAACU,KAAK,CAAC,MAAM,IAAI,CAACX,KAAK,CAACC,KAAK,CAAC,UAAU,CAAC,CAAC;IAChD,CAAC,CAAC;IAEF,IAAI,CAACD,KAAK,CAACM,GAAG,CAAC,UAAU,EAAE,MAAM;MAC7BR,YAAY,CAACiB,UAAU,CAAC,KAAK,CAAC;MAC9B,IAAI,CAACrB,IAAI,GAAG,IAAI;IACpB,CAAC,CAAC;EAEN;AACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}